import numpy as np
import matplotlib.pyplot as plt

def Math_FFT(value):
    # compute DFT with optimized FFT
    w = np.abs(np.fft.fft(value))
    n = np.size(w)
    half = int(n/2)
    x = np.linspace(0,1, np.size(w))
    x = x/dt


    n_L = w.tolist

    w_max = np.argmax(w)/(n-1)/dt * 0.01


    print("w_max = ", w_max)




    plt.plot(x[:half],w[:half])
    plt.show()

    


    return w_max



def Get_Lift_coeff():
    Lift_coeff = [
        0.0,-7.898750000734367e-07,-6.142737499881257e-06,-1.3103874999975673e-05,4.8418750000056576e-05,-0.0001744516250000716,-3.070075000011219e-05,-3.284249999990774e-05,-7.562624999901679e-06,-1.5528250000063082e-05,4.539353749988262e-05,-4.362565000004537e-05,2.2030075000012417e-05,3.702560000018451e-05,-3.3541137499981666e-05,-3.8883880000062376e-05,8.071594250003145e-05,-6.426013624993843e-05,-0.00010005315375005708,0.0001339081574999179,5.336806750000367e-05,-0.00025629050375008955,0.00017436688000005418,0.0003377849137500277,-0.00033691197499996495,-0.0001719605062500129,0.0005454919037501949,-9.562486250003221e-05,-0.000820142523749956,0.0007739488337500378,0.000600023294999974,-0.0017828874824999952,0.00033617750000003443,0.0021996580762498885,-0.0020810767025001287,-0.0017113885074999668,0.0044314442949999755,-0.0007650924737500064,-0.005970661256250009,0.005393575632500092,0.005017235142499854,-0.011733844587500042,0.0008755188175000317,0.01698978931250006,-0.014104126350000024,-0.01478380897500009,0.03179372593749996,-0.003263433637500035,-0.04331684864999996,0.0407305159250001,0.026076351750000004,-0.07893280962500004,0.03827511612500012,0.066395013625,-0.11414339424999997,0.0326752666250002,0.10200467375,-0.1448348650000001,0.03486361374999991,0.12308248850000003,-0.16973893212500002,0.04715850249999998,0.12859252374999997,-0.18797603524999995,0.06636595125000011,0.12194432899999996,-0.1995633928749999,0.08870248499999989,0.10711911012499986,-0.20519638750000002,0.11152966125000008,0.08713496487500005,-0.20571626875000004,0.1332947325,0.06395825774999997,-0.20182565875000003,0.15310610874999997,0.03885258674999992,-0.19405600850000004,0.1704182150000002,0.012638093374999881,-0.18281988537499982,0.18487072149999995,-0.014007658749999874,-0.16846268650000007,0.1962021896249999,-0.04059781125000017,-0.1513057900000001,0.20426000562500013,-0.06663378125000008,-0.13167102249999996,0.20889287737499984,-0.09164920624999984,-0.10989478000000008,0.210075672,-0.11520210249999996,-0.08633263375,0.20780014574999994,-0.13687102250000005,-0.061359386124999915,0.20213245287499992
    ]
    return Lift_coeff

def Get_Drag_coeff():
    Drag_coeff = [0.0,1.288684251,1.2331200639125002,1.18821733625,1.166113401,1.1532442631250002,1.14630194175,1.141677659625,1.138765445,1.1368604207500002,1.1355585209624999,1.1344138007,1.1339939692,1.1335561105249998,1.1331579168875001,1.1329743825874998,1.1327959755349999,1.1327848720287501,1.1326602757412498,1.1326178816099999,1.132559917125,1.13252208617625,1.13266792476,1.13257350463375,1.1324762859475002,1.13244116019125,1.13269616918125,1.1326008824175,1.13243108934375,1.1323725407412502,1.132594218805,1.1322044310675001,1.1323656293175,1.13244030544375,1.1325355451674999,1.1326242364775,1.1327632191700001,1.13264656737625,1.13306526676375,1.1327778731275,1.1328559173925,1.1335929914124998,1.1339838483325,1.1342473076875002,1.1351973329,1.136449323025,1.1385035498125,1.1407824956375001,1.1436314373499998,1.14762149095,1.1523182495,1.157608384375,1.162367168875,1.1690754486250001,1.17460746625,1.17857415375,1.1857945698749999,1.1896267150000002,1.19159631,1.19844595525,1.2004773337499999,1.2000981375,1.206324602,1.2075218875,1.2050318875000001,1.21049753525,1.21180772625,1.2077935075,1.212319675,1.21436407625,1.209442625,1.212818948875,1.2158761875000001,1.21059306625,1.21264342875,1.21670102875,1.21156123375,1.2121720737500001,1.21706206,1.2124828537499999,1.2116196383750002,1.21706993875,1.2133997562499999,1.211149325,1.21680017875,1.214304444625,1.2108010850000002,1.2163069928749999,1.215161033125,1.21064865,1.2156424056250001,1.215927034875,1.21070081375,1.2148595275000003,1.216560404375,1.210963395,1.2140142050000002,1.217023437125,1.2114209162499998,1.2131644775,1.2172892455
    ]
    return Drag_coeff


dt = 0.01

lift_coeff = Get_Lift_coeff()
drag_coeff = Get_Drag_coeff()

print('mean lift_coeff=', np.mean(lift_coeff))
print('mean drag_coeff=', np.mean(drag_coeff))

w1 = Math_FFT(lift_coeff)
w2 = Math_FFT(drag_coeff)



# print('lift coefficient frequency f=', f_cl)
# print('drag coefficient frequency f=', f_cd)


dt = 0.01
St = w1 *0.5/1 
print('St=', St)













